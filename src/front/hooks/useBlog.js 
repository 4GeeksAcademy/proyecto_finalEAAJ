import { useState } from 'react';
import { blogPosts as initialPosts } from '../assets/data/blogData';

export const useBlog = () => {
  const [posts, setPosts] = useState(initialPosts);
  const [selectedTab, setSelectedTab] = useState('blog');
  const [menuOpen, setMenuOpen] = useState(false);

  const addPost = (newPost) => {
    const post = {
      ...newPost,
      createdOn: Date.now(),
      comments: [],
      likes: 0,
      body: newPost.body.split('\n').filter(p => p.trim() !== '')
    };
    setPosts([post, ...posts]);
    setSelectedTab(0);
  };

  const addComment = (postIndex, comment) => {
    const updatedPosts = [...posts];
    updatedPosts[postIndex].comments.push({
      ...comment,
      createdOn: Date.now()
    });
    setPosts(updatedPosts);
  };

  const likePost = (postIndex) => {
    const updatedPosts = [...posts];
    updatedPosts[postIndex].likes += 1;
    setPosts(updatedPosts);
  };

  return {
    posts,
    selectedTab,
    menuOpen,
    setSelectedTab,
    setMenuOpen,
    addPost,
    addComment,
    likePost
  };
};